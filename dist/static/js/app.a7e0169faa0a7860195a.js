webpackJsonp([1],{GJl8:function(t,s){},LH0Z:function(t,s){},NHnr:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=e("7+uW"),a={render:function(){var t=this.$createElement,s=this._self._c||t;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},staticRenderFns:[]};var n=e("VU/8")({name:"App"},a,!1,function(t){e("d29T")},null,null).exports,c=e("/ocq"),o={name:"Login",data:function(){return{pwd:"",qq:""}},methods:{login:function(){if(!this.qq)return alert("qq号不能为空"),!1;if(!this.pwd)return alert("密码不能为空"),!1;var t={qq:this.qq,pwd:this.pwd,message_type:3};console.log(111),this.$emit("userlogin",t)},register:function(){console.log(1234),this.$emit("register","1234")}}},r={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"login-panel-wraper"},[e("div",{staticClass:"login-panel"},[e("div",{staticClass:"title"},[t._v("web qq")]),t._v(" "),e("div",{staticClass:"input-wraper"},[t._v("\n        账号："),e("input",{directives:[{name:"model",rawName:"v-model",value:t.qq,expression:"qq"}],attrs:{type:"text"},domProps:{value:t.qq},on:{input:function(s){s.target.composing||(t.qq=s.target.value)}}})]),t._v(" "),e("div",{staticClass:"input-wraper"},[t._v("\n        密码："),e("input",{directives:[{name:"model",rawName:"v-model",value:t.pwd,expression:"pwd"}],attrs:{type:"password"},domProps:{value:t.pwd},on:{input:function(s){s.target.composing||(t.pwd=s.target.value)}}})]),t._v(" "),e("button",{staticClass:"login-button",on:{click:t.register}},[t._v("注册")]),t._v(" "),e("button",{staticClass:"login-button",on:{click:t.login}},[t._v("登录")])])])])},staticRenderFns:[]};var l=e("VU/8")(o,r,!1,function(t){e("LH0Z")},"data-v-d9c18c7e",null).exports,d=e("mtWM"),h=e.n(d),u=e("mw3O"),g=e.n(u),v={name:"Register",data:function(){return{nickname:"",pwd:"",face_img:[{src:"1.jpg",flag:1},{src:"2.jpg",flag:2},{src:"3.jpg",flag:3},{src:"4.jpg",flag:4},{src:"5.jpg",flag:5},{src:"6.jpg",flag:6},{src:"7.jpg",flag:7}],face_check:"face_checed",face_url:""}},methods:{comfirm:function(){var t={pwd:this.pwd,nickname:this.nickname,avatar:this.face_url};h.a.post("http://catteacher.cn:9501/users/register",g.a.stringify(t)).then(function(t){console.log(t);var s=t.data;alert("账号申请成功："+s.qq)}).catch(function(t){console.log(t)})},checkface:function(t){this.face_url=t},register_close:function(){this.$emit("registerclose","432")}},mounted:function(){}},_={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"login-panel-wraper"},[e("div",{staticClass:"login-panel"},[e("div",{staticClass:"close",on:{click:t.register_close}}),t._v(" "),e("div",{staticClass:"title"},[t._v("注册")]),t._v(" "),e("div",{staticClass:"input-wraper"},[t._v("\n        昵称："),e("input",{directives:[{name:"model",rawName:"v-model",value:t.nickname,expression:"nickname"}],attrs:{type:"text"},domProps:{value:t.nickname},on:{input:function(s){s.target.composing||(t.nickname=s.target.value)}}})]),t._v(" "),e("div",{staticClass:"input-wraper"},[t._v("\n        密码："),e("input",{directives:[{name:"model",rawName:"v-model",value:t.pwd,expression:"pwd"}],attrs:{type:"password"},domProps:{value:t.pwd},on:{input:function(s){s.target.composing||(t.pwd=s.target.value)}}})]),t._v(" "),e("div",{staticClass:"input-wraper"},[t._v("头像：\n        "),e("ul",t._l(t.face_img,function(s,i){return e("li",[e("img",{class:{face_checed:t.face_url===s.flag},attrs:{src:"/static/img/"+s.src,alt:""},on:{click:function(e){t.checkface(s.flag)}}})])}),0)]),t._v(" "),e("div"),t._v(" "),e("div",{staticClass:"input-wraper"},[e("button",{staticClass:"login-button",on:{click:t.comfirm}},[t._v("提交")])])])])])},staticRenderFns:[]};var m=e("VU/8")(v,_,!1,function(t){e("xtWz")},"data-v-5015e72d",null).exports,p=e("mvHQ"),f=e.n(p),q={name:"Index",components:{Login:l,Register:m},data:function(){return{socket:"",friends:[],chatlist:{},chatpanel:[],chatpanelqq:[],message:"",loginshow:!1,registershow:!1,addfriendsshow:!1,logged:!1,islogout:!1,islogin:!1,userqq:"",userpwd:"",friend_qq:"",nickname:"",avatar:"/static/img/qq.jpeg",friendsshow:!0,groupshow:!1,messageshow:!1,header_active:"friends",chat_pannel_show:!1,current_qq:"",unread_num:"",unread_list:[],chat_unread:[],user:{}}},methods:{create_socket:function(){var t=this.$cookies.get("session_id");t||(t=""),this.socket=new WebSocket("ws://localhost:9501?session_id="+t),this.socket.onopen=function(t){console.log("websocket is open now")};var s=this;this.socket.onmessage=function(t){var e=JSON.parse(t.data);if(console.log(e),1===e.code)return alert(e.msg),!1;if(1==e.chat_type){s.current_qq!=e.to_qq&&(s.chat_unread[e.to_qq]||(s.chat_unread[e.to_qq]=0),s.chat_unread[e.to_qq]++);var i={img:"/static/img/"+s.friends[e.to_qq].avatar+".jpg",datetime:e.datetime,nickname:s.friends[e.to_qq].nickname,message:e.msg,class:"",class_face_item_right:"chat-face-item-right",class_chat_list_ul_li_right:"chat-mine"};s.$cookies.get("qq");console.log(s.chatlist),s.chatlist[e.to_qq]||(s.chatlist[e.to_qq]=[]),s.chatlist[e.to_qq].push(i),s.$forceUpdate(),s.current_qq&&s.scrollToBottom()}3==e.message_type&&(s.$cookies.set("session_id",e.session_id,"0"),s.$cookies.set("user",e.user,"0"),s.nickname=e.user.nickname,s.loginshow=!s.loginshow,s.islogin=!1,s.friends=e.friends,s.avatar="/static/img/"+e.user.avatar+".jpg",s.dealUnread(e.unread),s.check_login(),s.$forceUpdate()),4==e.message_type&&(s.friends=e.friends),5==e.message_type&&(alert(e.msg),0==e.code&&(this.addfriendsshow=!1)),e.message_type}},send:function(t,s){console.log(t,s);var e=this.$cookies.get("user"),i={to_qq:t,user_qq:this.$cookies.get("user").qq,message_type:1,chat_type:1,msg:this.message};console.log(i),this.socket.send(f()(i));var a={img:"/static/img/"+this.user.avatar+".jpg",datetime:"2019-10",nickname:e.nickname,message:this.message,class:"float-right",class_face_item_right:"",class_chat_list_ul_li_right:""};this.chatlist[t]||(this.chatlist[t]=[]),this.chatlist[t].push(a),this.message="",this.scrollToBottom()},login:function(){this.loginshow=!this.loginshow,this.registershow=!1},userlogin:function(t){this.socket.send(f()(t))},logout:function(){this.$cookies.remove("session_id"),this.$cookies.remove("user"),this.islogout=!1,this.islogin=!0,this.friends=[],this.nickname="",this.current_qq="",this.avatar="/static/img/qq.jpeg"},check_login:function(){if(this.$cookies.get("session_id")){this.islogout=!0;var t=this.$cookies.get("user");this.nickname=t.nickname}else this.islogin=!0},register:function(t){this.loginshow=!1,this.registershow=!0},registerclose:function(){this.registershow=!1},loggedsuccess:function(){this.islogout=!0,this.islogin=!1},addfriends:function(){this.addfriendsshow=!this.addfriendsshow},doaddfriend:function(){var t={user_qq:this.$cookies.get("user").qq,friend_qq:this.friend_qq,message_type:5};this.socket.send(f()(t))},addtopanel:function(t){if(this.current_qq=t.qq,this.chat_unread[t.qq]){var s=this.$cookies.get("user");this.setRead(t.qq,s.qq)}this.chat_unread[t.qq]="",-1===this.chatpanelqq.indexOf(t.qq)&&(this.chatpanel.push(t),this.chatpanelqq.push(t.qq))},chatpanel_close:function(t){this.current_qq=!1},scrollToBottom:function(){this.$nextTick(function(){var t=document.querySelector("#chatmessage");t.scrollTop=t.scrollHeight})},switchpanel:function(t){"group"==t?(this.groupshow=!0,this.friendsshow=!1,this.messageshow=!1,this.header_active=t):"message"==t?(this.groupshow=!1,this.friendsshow=!1,this.messageshow=!0,this.header_active=t):"friends"==t&&(this.groupshow=!1,this.friendsshow=!0,this.messageshow=!1,this.header_active=t)},dealUnread:function(t){for(var s=0;s<t.length;s++)this.addMsg(t[s])},addMsg:function(t){this.chat_unread[t.qq]||(this.chat_unread[t.qq]=0),this.chat_unread[t.qq]++;var s={img:"/static/img/"+this.friends[t.qq].avatar+".jpg",datetime:"2019-01",nickname:this.friends[t.qq].nickname,message:t.message,class:"",class_face_item_right:"chat-face-item-left",class_chat_list_ul_li_right:"chat-list-ul-li-left"};this.$cookies.get("qq");this.chatlist[t.qq]||(this.chatlist[t.qq]=[]),this.chatlist[t.qq].push(s)},setRead:function(t,s){var e={qq:t,to_qq:s,message_type:6};this.socket.send(f()(e))}},mounted:function(){this.socket||this.create_socket(),this.check_login(),this.$cookies.get("user")&&(this.user=this.$cookies.get("user"),this.avatar="/static/img/"+this.user.avatar+".jpg")},updated:function(){}},w={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("Login",{directives:[{name:"show",rawName:"v-show",value:t.loginshow,expression:"loginshow"}],on:{click:t.login,userlogin:t.userlogin,register:t.register}}),t._v(" "),e("Register",{directives:[{name:"show",rawName:"v-show",value:t.registershow,expression:"registershow"}],on:{registerclose:t.registerclose}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.addfriendsshow,expression:"addfriendsshow"}],staticClass:"addfriends"},[t._v("\n    输入好友qq号：\n    "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.friend_qq,expression:"friend_qq"}],attrs:{type:"text"},domProps:{value:t.friend_qq},on:{input:function(s){s.target.composing||(t.friend_qq=s.target.value)}}}),t._v(" "),e("button",{staticStyle:{cursor:"pointer"},on:{click:t.doaddfriend}},[t._v("提交")])]),t._v(" "),e("div",{staticClass:"contenier"},[e("div",{staticClass:"header"},[t.islogin?e("div",{staticClass:"login-button",on:{click:t.login}},[t._v("登录")]):t._e(),t._v(" "),t.islogout?e("div",{staticClass:"login-button",on:{click:t.logout}},[t._v("退出")]):t._e(),t._v(" "),e("div",{staticClass:"close"}),t._v(" "),e("div",{staticClass:"header-img"},[e("img",{attrs:{src:t.avatar,alt:""}})]),t._v(" "),e("span",[t._v(t._s(t.nickname))]),t._v(" "),e("div",{staticClass:"header-box"},[e("div",{staticClass:"header-item",class:{header_item_active:"friends"==t.header_active},on:{click:function(s){t.switchpanel("friends")}}},[t._v("好友")]),t._v(" "),e("div",{staticClass:"header-item",class:{header_item_active:"group"==t.header_active},on:{click:function(s){t.switchpanel("group")}}},[t._v("群")]),t._v(" "),e("div",{staticClass:"header-item message",class:{header_item_active:"message"==t.header_active},on:{click:function(s){t.switchpanel("message")}}},[t._v("\n          消息\n          "),e("div",{staticClass:"unread"},[t._v(t._s(t.unread_num))])])])]),t._v(" "),e("div",{staticClass:"panel-content"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.friendsshow,expression:"friendsshow"}],staticClass:"friends"},[e("ul",{staticClass:"conent-list"},t._l(this.friends,function(s){return e("li",{staticClass:"friend",on:{click:function(e){t.addtopanel(s)}}},[e("img",{staticClass:"face",attrs:{src:"/static/img/"+s.avatar+".jpg",alt:""}}),t._v(t._s(s.nickname)+"\n            "),e("div",{staticClass:"friend_unread"},[t._v(t._s(t.chat_unread[s.qq]))])])}),0)]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.groupshow,expression:"groupshow"}]},[t._m(0)]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.messageshow,expression:"messageshow"}]},[e("ul",t._l(t.unread_list,function(t){return e("li")}),0)])]),t._v(" "),e("div",{staticClass:"footer"},[e("span",{staticClass:"addfriends-button",on:{click:t.addfriends}},[t._v("添加好友")])])]),t._v(" "),t._l(t.chatpanel,function(s){return e("div",{directives:[{name:"show",rawName:"v-show",value:s.qq===t.current_qq,expression:"user.qq === current_qq"}],staticClass:"chat-panel",attrs:{id:"1"}},[e("div",{staticClass:"close",on:{click:function(e){t.chatpanel_close(s.qq)}}}),t._v(" "),e("div",{staticClass:"chat-title",attrs:{id:"5"}},[t._v(t._s(s.nickname))]),t._v(" "),e("div",{staticStyle:{display:"flex"}},[t._m(1,!0),t._v(" "),e("div",{staticClass:"chat-right"},[e("div",{staticClass:"chat-list",attrs:{id:"chatmessage"}},[e("ul",t._l(t.chatlist[s.qq],function(s){return e("li",{class:s.class_chat_list_ul_li_right},[e("div",{staticClass:"chat-face-item",class:s.class_face_item_right},[e("img",{staticClass:"chat-face",attrs:{src:s.img,alt:""}}),t._v(" "),e("cite",[t._v("\n                  "+t._s(s.datetime)+"\n                  "),e("i",[t._v(t._s(s.nickname))])])]),t._v(" "),e("div",{staticClass:"chat-list-text"},[t._v("\n                "+t._s(s.message)+"\n              ")])])}),0)]),t._v(" "),e("div",{staticClass:"chat-input"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],attrs:{name:"",id:"",cols:"50",rows:"5"},domProps:{value:t.message},on:{input:function(s){s.target.composing||(t.message=s.target.value)}}}),t._v(" "),e("div",{staticClass:"to-message",on:{click:function(e){t.send(s.qq,s.nickname)}}},[t._v("发送")])])])])])})],2)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("ul",{staticClass:"conent-list"},[s("li",{staticClass:"friend qqgroup"},[this._v("webqq在线用户")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"chat-left"},[s("ul",[s("li",[s("img",{staticClass:"face",attrs:{src:"/static/img/1.jpg",alt:""}}),this._v(" 大花猫\n          ")])])])}]};var k=e("VU/8")(q,w,!1,function(t){e("GJl8")},"data-v-39051e5e",null).exports;i.a.use(c.a);var C=new c.a({routes:[{path:"/register",name:"Register",component:m},{path:"/",name:"Index",component:k,children:[{path:"login",component:l}]}]}),x=e("ppUw"),$=e.n(x),y=(e("m0iu"),e("qJdI")),b=e.n(y);i.a.config.productionTip=!1,i.a.use($.a),i.a.use(b.a),new i.a({el:"#app",router:C,components:{App:n},template:"<App/>"})},d29T:function(t,s){},m0iu:function(t,s){},xtWz:function(t,s){}},["NHnr"]);
//# sourceMappingURL=app.a7e0169faa0a7860195a.js.map