webpackJsonp([1],{LH0Z:function(s,e){},NHnr:function(s,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=t("7+uW"),a={render:function(){var s=this.$createElement,e=this._self._c||s;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var n=t("VU/8")({name:"App"},a,!1,function(s){t("d29T")},null,null).exports,c=t("/ocq"),o={name:"Login",data:function(){return{pwd:"",qq:""}},methods:{login:function(){if(!this.qq)return alert("qq号不能为空"),!1;if(!this.pwd)return alert("密码不能为空"),!1;var s={qq:this.qq,pwd:this.pwd,message_type:3};console.log(111),this.$emit("userlogin",s)},register:function(){console.log(1234),this.$emit("register","1234")}}},r={render:function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",[t("div",{staticClass:"login-panel-wraper"},[t("div",{staticClass:"login-panel"},[t("div",{staticClass:"title"},[s._v("web qq")]),s._v(" "),t("div",{staticClass:"input-wraper"},[s._v("\n        账号："),t("input",{directives:[{name:"model",rawName:"v-model",value:s.qq,expression:"qq"}],attrs:{type:"text"},domProps:{value:s.qq},on:{input:function(e){e.target.composing||(s.qq=e.target.value)}}})]),s._v(" "),t("div",{staticClass:"input-wraper"},[s._v("\n        密码："),t("input",{directives:[{name:"model",rawName:"v-model",value:s.pwd,expression:"pwd"}],attrs:{type:"password"},domProps:{value:s.pwd},on:{input:function(e){e.target.composing||(s.pwd=e.target.value)}}})]),s._v(" "),t("button",{staticClass:"login-button",on:{click:s.register}},[s._v("注册")]),s._v(" "),t("button",{staticClass:"login-button",on:{click:s.login}},[s._v("登录")])])])])},staticRenderFns:[]};var l=t("VU/8")(o,r,!1,function(s){t("LH0Z")},"data-v-d9c18c7e",null).exports,h=t("mtWM"),d=t.n(h),_=t("mw3O"),u=t.n(_),p={name:"Register",data:function(){return{nickname:"",pwd:"",face_img:[{src:"1.jpg",flag:1},{src:"2.jpg",flag:2},{src:"3.jpg",flag:3},{src:"4.jpg",flag:4},{src:"5.jpg",flag:5},{src:"6.jpg",flag:6},{src:"7.jpg",flag:7},{src:"8.jpg",flag:8}],face_check:"face_checed",face_url:""}},methods:{comfirm:function(){var s={pwd:this.pwd,nickname:this.nickname,avatar:this.face_url};d.a.post("http://catteacher.cn:9501/users/register",u.a.stringify(s)).then(function(s){console.log(s);var e=s.data;alert("账号申请成功："+e.qq)}).catch(function(s){console.log(s)})},checkface:function(s){this.face_url=s},register_close:function(){this.$emit("registerclose","432")}},mounted:function(){}},v={render:function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",[t("div",{staticClass:"login-panel-wraper"},[t("div",{staticClass:"login-panel"},[t("div",{staticClass:"close",on:{click:s.register_close}}),s._v(" "),t("div",{staticClass:"title"},[s._v("注册")]),s._v(" "),t("div",{staticClass:"input-wraper"},[s._v("\n        昵称："),t("input",{directives:[{name:"model",rawName:"v-model",value:s.nickname,expression:"nickname"}],attrs:{type:"text"},domProps:{value:s.nickname},on:{input:function(e){e.target.composing||(s.nickname=e.target.value)}}})]),s._v(" "),t("div",{staticClass:"input-wraper"},[s._v("\n        密码："),t("input",{directives:[{name:"model",rawName:"v-model",value:s.pwd,expression:"pwd"}],attrs:{type:"password"},domProps:{value:s.pwd},on:{input:function(e){e.target.composing||(s.pwd=e.target.value)}}})]),s._v(" "),t("div",{staticClass:"input-wraper"},[s._v("头像：\n        "),t("ul",s._l(s.face_img,function(e,i){return t("li",[t("img",{class:{face_checed:s.face_url===e.flag},attrs:{src:"/static/img/"+e.src,alt:""},on:{click:function(t){s.checkface(e.flag)}}})])}),0)]),s._v(" "),t("div"),s._v(" "),t("div",{staticClass:"input-wraper"},[t("button",{staticClass:"login-button",on:{click:s.comfirm}},[s._v("提交")])])])])])},staticRenderFns:[]};var m=t("VU/8")(p,v,!1,function(s){t("phOL")},"data-v-4e468096",null).exports,g=t("mvHQ"),q=t.n(g),f={MESSAGE_TYPE_CHAT:1,MESSAGE_TYPE_REGISTER:2,MESSAGE_TYPE_LOGIN:3,MESSAGE_TYPE_FRIENDS:4,MESSAGE_TYPE_ADD_FRIENDS:5,MESSAGE_TYPE_READ:6,MESSAGE_TYPE_ONLINE_USER_NUM:7,MESSAGE_TYPE_ONOPEN:8,MESSAGE_TYPE_LOGOUT:9,CODE_SUCCESS:0,CODE_ERROR:1},w={name:"Index",components:{Login:l,Register:m},data:function(){return{socket:"",friends:[],chatlist:[],chatpanel:[],chatpanelqq:[],message:[],loginshow:!1,registershow:!1,addfriendsshow:!1,logged:!1,islogout:!1,islogin:!1,friend_qq:"",nickname:"",avatar:"/static/img/qq.jpeg",panelshow:"friends",header_active:"friends",chat_pannel_show:!1,current_qq:"",unread_num:"",online_unread:"",unread_list:[],chat_unread:[],user:{},groups:[],online_user_num:"",chatfocus:!0,pannel_side:[],panel_close_show:"",pannel_side_qq:[],panel_small:!1,main_panel_show:!0}},methods:{create_socket:function(){var s=this.$cookies.get("session_id");s||(s=""),this.socket=new WebSocket("ws://catteacher.cn:9501?session_id="+s),this.socket.onopen=function(s){console.log("websocket is open now")};var e=this;this.socket.onmessage=function(s){var t=JSON.parse(s.data);if(console.log(t),1===t.code)return alert(t.msg),!1;switch((t=t.data).message_type){case f.MESSAGE_TYPE_CHAT:e.handleChat(t);break;case f.MESSAGE_TYPE_LOGIN:e.handleLogin(t);break;case f.MESSAGE_TYPE_ADD_FRIENDS:e.handleAddFriends(t)}4==t.message_type&&(e.friends=t.friends,e.online_user_num=t.unline_user_num,e.$forceUpdate()),t.message_type,7===t.message_type&&(e.online_user_num=t.unline_user_num),8===t.message_type&&(e.friends=t.friends,e.online_user_num=t.unline_user_num)}},send:function(s,e){if(this.message[s]){var t=this.$cookies.get("user");if(t){var i={to_qq:s,user_qq:t?t.qq:"",message_type:1,chat_type:1,msg:this.message[s]};"all"==s&&(i.chat_type=2),this.socket.send(q()(i));var a={img:"/static/img/"+t.avatar+".jpg",datetime:"2019-10",nickname:t?t.nickname:"qq",message:this.message[s],class:"chat-mine"};this.chatlist[s]||(this.chatlist[s]=[]),this.chatlist[s].push(a),this.message[s]="",this.$forceUpdate(),this.scrollToBottom()}else this.unlogin_send(s)}else this.chatfocus=!0},unlogin_send:function(s){var e={img:"/static/img/qq.jpeg",datetime:"2019-10",nickname:"登录后聊天",message:this.message,class:"float-right",class_face_item_right:"",class_chat_list_ul_li_right:""};this.chatlist[s]||(this.chatlist[s]=[]),this.chatlist[s].push(e),this.message="",this.scrollToBottom()},login:function(){this.loginshow=!this.loginshow,this.registershow=!1,this.current_qq=""},userlogin:function(s){this.socket.send(q()(s))},logout:function(){var s={message_type:f.MESSAGE_TYPE_LOGOUT,qq:this.user.qq};this.socket.send(q()(s)),this.$cookies.remove("session_id"),this.$cookies.remove("user"),this.user="",this.islogout=!1,this.islogin=!0,this.friends=[],this.nickname="",this.current_qq="",this.avatar="/static/img/qq.jpeg",this.pannel_side_qq=[],this.pannel_side=[],this.chatpanelqq=[],this.chatpanel=[]},check_login:function(){if(this.$cookies.get("session_id")){this.islogout=!0;var s=this.$cookies.get("user");this.nickname=s.nickname}else this.islogin=!0},register:function(s){this.loginshow=!1,this.registershow=!0},registerclose:function(){this.registershow=!1},loggedsuccess:function(){this.islogout=!0,this.islogin=!1},addfriends:function(){if(!this.$cookies.get("session_id"))return alert("未登录"),!1;this.current_qq="",this.addfriendsshow=!this.addfriendsshow},doaddfriend:function(){var s={user_qq:this.$cookies.get("user").qq,friend_qq:this.friend_qq,message_type:5,session_id:this.$cookies.get("session_id")};this.socket.send(q()(s))},addtopanel:function(s){if(this.addfriendsshow=!1,this.loginshow=!1,this.current_qq=s.qq,this.chat_unread[s.qq]){var e=this.$cookies.get("user");this.setRead(s.qq,e.qq)}this.chat_unread[s.qq]="",-1===this.chatpanelqq.indexOf(s.qq)&&(this.chatpanel.push(s),this.chatpanelqq.push(s.qq)),-1===this.pannel_side_qq.indexOf(s.qq)&&(this.pannel_side.push(s),this.pannel_side_qq.push(s.qq)),this.scrollToBottom(),this.$forceUpdate()},chatpanel_close:function(s){this.current_qq=!1},scrollToBottom:function(){var s=this;this.$nextTick(function(){var e=document.getElementById("abc"+s.current_qq);e.scrollTop=e.scrollHeight})},switchpanel:function(s){this.panelshow=s,this.header_active=s},dealUnread:function(s){for(var e=0;e<s.length;e++)this.addMsg(s[e])},addMsg:function(s){this.chat_unread[s.qq]||(this.chat_unread[s.qq]=0),this.chat_unread[s.qq]++;var e={img:"/static/img/"+this.friends[s.qq].avatar+".jpg",datetime:"2019-01",nickname:this.friends[s.qq].nickname,message:s.message,class:""};this.$cookies.get("qq");this.chatlist[s.qq]||(this.chatlist[s.qq]=[]),this.chatlist[s.qq].push(e)},setRead:function(s,e){var t={qq:s,to_qq:e,message_type:6};this.socket.send(q()(t))},add_group_panel:function(){this.online_unread="";var s={qq:"all",nickname:"webqq在线用户",avatar:"group"};-1===this.chatpanelqq.indexOf("all")&&(this.chatpanel.push(s),this.chatpanelqq.push("all")),console.log(this.pannel_side_qq),console.log(this.chatpanel),-1===this.pannel_side_qq.indexOf("all")&&(this.pannel_side.push(s),this.pannel_side_qq.push("all")),this.current_qq="all",this.scrollToBottom()},addfriends_close:function(){this.addfriendsshow=!1},handleChat:function(s){this.$refs.msgwav.play(),this.current_qq!=s.to_qq&&(this.chat_unread[s.to_qq]||(this.chat_unread[s.to_qq]=0),this.chat_unread[s.to_qq]++);var e="",t="";2==s.chat_type?("all"!=this.current_qq&&this.online_unread++,e="/static/img/"+s.userinfo.avatar+".jpg",t=s.userinfo.nickname):(e="/static/img/"+this.friends[s.to_qq].avatar+".jpg",t=this.friends[s.to_qq].nickname);var i={img:e,datetime:s.datetime,nickname:t,message:s.msg,class:"",class_face_item_right:"chat-face-item-right",class_chat_list_ul_li_right:""};this.chatlist[s.to_qq]||(this.chatlist[s.to_qq]=[]),this.chatlist[s.to_qq].push(i),this.$forceUpdate(),this.current_qq&&this.scrollToBottom()},handleLogin:function(s){this.$cookies.set("session_id",s.session_id,"0"),this.$cookies.set("user",s.user,"0"),this.nickname=s.user.nickname,this.loginshow=!this.loginshow,this.islogin=!1,this.friends=s.friends,this.avatar="/static/img/"+s.user.avatar+".jpg",this.dealUnread(s.unread),this.check_login(),this.$forceUpdate()},handleAddFriends:function(s){alert("添加成功"),this.addfriendsshow=!1,this.friends=s.friends,this.$forceUpdate()},pannel_side_close:function(s){for(var e=0;e<this.pannel_side.length;e++){if(this.pannel_side[e].qq==s){this.pannel_side.splice(e,1);var t=this.pannel_side_qq.indexOf(s);this.pannel_side_qq.splice(t,1),s==this.current_qq&&(this.current_qq=this.pannel_side_qq.pop());break}}},showclose:function(s){this.panel_close_show=s},closeshow:function(){this.panel_close_show=""},switch_chat_side:function(s){this.current_qq=s},switch_main_panel:function(){this.main_panel_show=!this.main_panel_show,this.panel_small=!this.panel_small}},mounted:function(){this.socket||this.create_socket(),this.check_login(),this.$cookies.get("user")&&(this.user=this.$cookies.get("user"),this.avatar="/static/img/"+this.user.avatar+".jpg")},updated:function(){},directives:{focus:{update:function(s,e){e.value&&s.focus()}}}},k={render:function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",[t("Login",{directives:[{name:"show",rawName:"v-show",value:s.loginshow,expression:"loginshow"}],on:{click:s.login,userlogin:s.userlogin,register:s.register}}),s._v(" "),t("Register",{directives:[{name:"show",rawName:"v-show",value:s.registershow,expression:"registershow"}],on:{registerclose:s.registerclose}}),s._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:s.addfriendsshow,expression:"addfriendsshow"}],staticClass:"addfriends"},[t("div",{staticClass:"close",on:{click:function(e){s.addfriends_close()}}}),s._v("\n    输入好友qq号：\n    "),t("input",{directives:[{name:"model",rawName:"v-model",value:s.friend_qq,expression:"friend_qq"}],attrs:{type:"text"},domProps:{value:s.friend_qq},on:{input:function(e){e.target.composing||(s.friend_qq=e.target.value)}}}),s._v(" "),t("button",{staticStyle:{cursor:"pointer"},on:{click:s.doaddfriend}},[s._v("提交")])]),s._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:s.panel_small,expression:"panel_small"}],staticClass:"main_panel_small",on:{click:s.switch_main_panel}},[t("img",{attrs:{src:"/static/img/qq.jpeg",alt:""}})]),s._v(" "),t("audio",{ref:"msgwav",attrs:{src:"/static/audio/msg.mp3",id:"msgwav"}}),s._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:s.main_panel_show,expression:"main_panel_show"}],staticClass:"contenier"},[t("div",{staticClass:"header"},[s.islogin?t("div",{staticClass:"login-button",on:{click:s.login}},[s._v("登录")]):s._e(),s._v(" "),s.islogout?t("div",{staticClass:"login-button",on:{click:s.logout}},[s._v("退出")]):s._e(),s._v(" "),t("div",{staticClass:"close",on:{click:s.switch_main_panel}}),s._v(" "),t("div",{staticClass:"header-img"},[t("img",{attrs:{src:s.avatar,alt:""}})]),s._v(" "),t("span",[s._v(s._s(s.nickname))]),s._v(" "),t("div",{staticClass:"header-box"},[t("div",{staticClass:"header-item",class:{header_item_active:"friends"==s.header_active},on:{click:function(e){s.switchpanel("friends")}}},[s._v("好友")]),s._v(" "),t("div",{staticClass:"header-item",class:{header_item_active:"group"==s.header_active},on:{click:function(e){s.switchpanel("group")}}},[s._v("群")]),s._v(" "),t("div",{staticClass:"header-item message",class:{header_item_active:"message"==s.header_active},on:{click:function(e){s.switchpanel("message")}}},[s._v("\n          消息\n          "),t("div",{staticClass:"unread"},[s._v(s._s(s.unread_num))])])])]),s._v(" "),t("div",{staticClass:"panel-content"},[t("div",{directives:[{name:"show",rawName:"v-show",value:"friends"===s.panelshow,expression:"panelshow==='friends'"}],staticClass:"friends"},[t("ul",{staticClass:"conent-list"},s._l(this.friends,function(e){return t("li",{staticClass:"friend",on:{click:function(t){s.addtopanel(e)}}},[t("img",{staticClass:"face",attrs:{src:"/static/img/"+e.avatar+".jpg",alt:""}}),s._v(s._s(e.nickname)+"\n            "),t("div",{staticClass:"friend_unread"},[s._v(s._s(s.chat_unread[e.qq]))])])}),0)]),s._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:"group"===s.panelshow,expression:"panelshow==='group'"}]},[t("ul",{staticClass:"conent-list"},[t("li",{staticClass:"friend qqgroup",on:{click:s.add_group_panel}},[t("img",{staticClass:"face",attrs:{src:"/static/img/group.jpg",alt:""}}),s._v("\n            webqq在线用户\n            "),t("span",{staticStyle:{color:"#5fb878"}},[s._v("("+s._s(s.online_user_num)+")")]),s._v(" "),t("div",{staticClass:"friend_unread"},[s._v(s._s(s.online_unread))])]),s._v(" "),s._l(s.groups,function(e){return t("li",{staticClass:"friend qqgroup"},[s._v("\n            "+s._s(e.group_name)+"\n\n          ")])})],2)]),s._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:"message"===s.panelshow,expression:"panelshow==='message'"}]},[t("ul",s._l(s.unread_list,function(s){return t("li")}),0)])]),s._v(" "),t("div",{staticClass:"footer"},[t("span",{staticClass:"addfriends-button",on:{click:s.addfriends}},[s._v("+")])])]),s._v(" "),s._l(s.chatpanel,function(e){return t("div",{directives:[{name:"show",rawName:"v-show",value:e.qq===s.current_qq,expression:"user.qq === current_qq"}],staticClass:"chat-panel",attrs:{id:"1"}},[t("div",{staticClass:"close",on:{click:function(t){s.chatpanel_close(e.qq)}}}),s._v(" "),t("div",{staticClass:"chat-title",attrs:{id:"5"}},[s._v(s._s(e.nickname))]),s._v(" "),t("div",{staticStyle:{display:"flex"}},[t("div",{staticClass:"chat-left"},[t("ul",s._l(s.pannel_side,function(e){return t("li",{class:{pannel_side_list:e.qq===s.current_qq},on:{mouseenter:function(t){s.showclose(e.qq)},mouseleave:s.closeshow,click:function(t){s.switch_chat_side(e.qq)}}},[t("div",{directives:[{name:"show",rawName:"v-show",value:s.panel_close_show==e.qq,expression:"panel_close_show==item.qq"}],staticClass:"pannel-side-close",on:{click:[function(t){s.pannel_side_close(e.qq)},function(s){s.stopPropagation()}]}}),s._v(" "),t("img",{staticClass:"face",attrs:{src:"/static/img/"+e.avatar+".jpg",alt:""}}),s._v(" "+s._s(e.nickname)+"\n          ")])}),0)]),s._v(" "),t("div",{staticClass:"chat-right"},[t("div",{staticClass:"chat-list"},[t("ul",{staticClass:"chatbox",attrs:{id:"abc"+e.qq}},s._l(s.chatlist[e.qq],function(e){return t("li",{class:e.class},[t("div",{staticClass:"chat-face-item"},[t("img",{staticClass:"chat-face",attrs:{src:e.img,alt:""}}),s._v(" "),t("cite",[s._v("\n                  "+s._s(e.datetime)+"\n                  "),t("i",[s._v(s._s(e.nickname))])])]),s._v(" "),t("div",{staticClass:"chat-list-text"},[s._v("\n                "+s._s(e.message)+"\n              ")])])}),0)]),s._v(" "),t("div",{staticClass:"chat-input"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:s.message[e.qq],expression:"message[user.qq]"},{name:"focus",rawName:"v-focus",value:s.chatfocus,expression:"chatfocus"}],attrs:{name:"",autofocus:"autofocus",cols:"50",rows:"5"},domProps:{value:s.message[e.qq]},on:{keyup:function(t){return("button"in t||!s._k(t.keyCode,"enter",13,t.key,"Enter"))&&t.ctrlKey?void s.send(e.qq,e.nickname):null},input:function(t){t.target.composing||s.$set(s.message,e.qq,t.target.value)}}}),s._v(" "),t("div",{staticClass:"to-message",on:{click:function(t){s.send(e.qq,e.nickname)}}},[s._v("发送")])])])])])})],2)},staticRenderFns:[]};var C=t("VU/8")(w,k,!1,function(s){t("bU/x")},"data-v-549bcb97",null).exports;i.a.use(c.a);var E=new c.a({routes:[{path:"/register",name:"Register",component:m},{path:"/",name:"Index",component:C,children:[{path:"login",component:l}]}]}),x=t("ppUw"),S=t.n(x),$=(t("m0iu"),t("qJdI")),b=t.n($);i.a.config.productionTip=!1,i.a.use(S.a),i.a.use(b.a),new i.a({el:"#app",router:E,components:{App:n},template:"<App/>"})},"bU/x":function(s,e){},d29T:function(s,e){},m0iu:function(s,e){},phOL:function(s,e){}},["NHnr"]);
//# sourceMappingURL=app.b235044a63e82b39eac6.js.map